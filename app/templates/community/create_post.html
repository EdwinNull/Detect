{% extends "base.html" %}

{% block title %}发布帖子 - 安全社区{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/community.css') }}">
{% endblock %}

{% block content %}
<div class="create-post-container">
    <div class="create-post-header">
        <h1><i class="fas fa-edit"></i> 发布新帖子</h1>
        <p>分享您的安全检测发现，帮助社区用户提高安全意识</p>
    </div>
    
    <div class="create-post-form">
        <div class="tips">
            <h4><i class="fas fa-lightbulb"></i> 发帖建议</h4>
            <ul>
                <li>详细描述恶意包的特征和行为</li>
                <li>提供具体的防护建议和解决方案</li>
                <li>分享检测过程中的经验和技巧</li>
                <li>使用清晰的语言，便于其他用户理解</li>
            </ul>
        </div>
        
        {% if scan_record %}
        <div class="scan-info">
            <h4><i class="fas fa-box-open"></i> 关联检测记录</h4>
            <div class="scan-details">
                <div class="scan-detail">
                    <span>文件名：</span>
                    <span>{{ scan_record.filename }}</span>
                </div>
                <div class="scan-detail">
                    <span>包类型：</span>
                    <span>{{ scan_record.package_type or '未知' }}</span>
                </div>
                <div class="scan-detail">
                    <span>风险等级：</span>
                    <span class="risk-badge risk-{{ scan_record.risk_level or 'low' }}">
                        {{ scan_record.risk_level or '未知' }}
                    </span>
                </div>
                <div class="scan-detail">
                    <span>置信度：</span>
                    <span>{{ "%.1f"|format(scan_record.confidence or 0) }}%</span>
                </div>
            </div>
        </div>
        {% endif %}
        
        <form method="post">
            {% if scan_record %}
            <input type="hidden" name="scan_id" value="{{ scan_record.id }}">
            {% endif %}
            
            <div class="form-group">
                <label for="title" class="form-label">标题 <span style="color: #f56c6c">*</span></label>
                <input type="text" id="title" name="title" class="form-input" 
                       placeholder="请输入帖子标题..." required
                       value="{{ scan_record.filename + ' - 安全检测发现' if scan_record else '' }}">
            </div>
            
            <div class="form-group">
                <label for="category" class="form-label">分类</label>
                <select id="category" name="category" class="form-input">
                    <option value="discovery" selected>安全发现</option>
                    <option value="discussion">讨论</option>
                    <option value="question">问题求助</option>
                    <option value="tutorial">教程</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="content" class="form-label">内容 <span style="color: #f56c6c">*</span></label>
                <textarea id="content" name="content" class="form-textarea" 
                          placeholder="请详细描述您的发现..." required>{% if scan_record %}
检测发现：{{ scan_record.filename }}

风险等级：{{ scan_record.risk_level or '未知' }}
置信度：{{ "%.1f"|format(scan_record.confidence or 0) }}%

详细分析：
[请在此处详细描述检测结果、恶意行为特征、潜在危害等]

防护建议：
[请在此处提供具体的防护措施和建议]

{% endif %}</textarea>
            </div>
            
            <div class="form-actions">
                <div>
                    <a href="{{ url_for('community.index') }}" class="action-btn">
                        <i class="fas fa-times"></i> 取消
                    </a>
                </div>
                <div>
                    <button type="submit" class="create-post-btn">
                        <i class="fas fa-paper-plane"></i> 发布帖子
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock %} 